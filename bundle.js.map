{"version":3,"sources":["webpack:///webpack/bootstrap c8f15c15d91eff3e75b6","webpack:///./PrimeOrdeal.js","webpack:///./js/view.js","webpack:///./js/game.js","webpack:///./js/bubble.js","webpack:///./js/layout.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;;AAEA;AACA;AACA;AACA;AACA,EAAC,E;;;;;;ACND;;AAEA;AACA;AACA,yFAAwF;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACvGA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD,UAAU;AAC5D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA,kBAAiB,sBAAsB;AACvC;AACA,yCAAwC,cAAc;AACtD,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA,IAAG;;AAEH,kBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;;AAGA;;AAEA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,yBAAyB;;AAE1C;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,kBAAiB,yBAAyB;AAC1C;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,sBAAqB,yBAAyB;AAC9C;;AAEA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,yB;;;;;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c8f15c15d91eff3e75b6\n **/","var View = require('./js/view.js');\n\ndocument.addEventListener(\"DOMContentLoaded\", function(){\n\tvar canvas = document.getElementById(\"canvas\");\n\tvar ctx = canvas.getContext('2d');\n\tnew View(ctx).start();\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./PrimeOrdeal.js\n ** module id = 0\n ** module chunks = 0\n **/","var Game = require('./game.js');\n\nvar View = function(ctx){\n  this.ctx = ctx;\n  this.game = new Game(ctx, this.changePage.bind(this, 1), this.togglePause.bind(this)); //I could set difficulties, which takes in # of bubble to start with\n  this.page = 1;\n  this.pause = false;\n  this.setUpListeners();\n};\nView.prototype.togglePause = function(){\n\tthis.pause = this.pause ? false : true;\n};\n\nView.prototype.setUpListeners = function(){\n  this.startBtn = document.getElementById(\"start\"),\n \tthis.instructionBtn = document.getElementById(\"instruction\"),\n \tthis.retryBtn = document.getElementById(\"retry\"),\n \tthis.backIcon = document.getElementById(\"back-icon\"),\n \tthis.backIcon.addEventListener(\"click\", this.changePage.bind(this, 1));\n  this.startBtn.addEventListener(\"click\", this.changePage.bind(this, 2));\n  this.retryBtn.addEventListener(\"click\", this.changePage.bind(this, 1));\n\n  $('#myModal').on(\"hidden.bs.modal\", this.togglePause.bind(this));\n  $('#myModal').on(\"shown.bs.modal\", this.togglePause.bind(this));\n};\n\nView.prototype.changePage = function(page, e){\n\tthis.page = page;\n\tif (e.target.id === \"retry\" || e.target.id ===\"back-icon\"){\n\t\tthis.game = new Game(this.ctx, this.changePage.bind(this, 1));\n\t}\n\tswitch (page){\n\t\tcase 2:\n\t\t\tthis.instructionBtn.className = \"\";\n\t\t\tthis.backIcon.className = \"\";\n\t\t\tthis.startBtn.className = \"hidden\";\n\t\t\tthis.retryBtn.className = \"hidden\";\n\t\t\t$(\"#myModal\").modal(\"show\");\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tthis.startBtn.className = \"\";\n\t\t\tthis.instructionBtn.className = \"hidden\";\n\t\t\tthis.retryBtn.className = \"hidden\";\n\t\t\tthis.backIcon.className = \"hidden\";\n\t\t\tbreak;\n\t\t}\n};\n\nView.prototype.start = function() {\n    var intId = setInterval(function(){\n    \tswitch (this.page){\n    \t\tcase 1:\n    \t\t\tthis.startScreen();\n    \t\t\tbreak;\n    \t\tcase 2:\n    \t\t\tif (!this.pause){\n\t    \t\t\tthis.gameScreen.call(this, intId);\n    \t\t\t}\n    \t\t\tbreak;\n    \t\tcase 5:\n    \t\t  this.loseScreen.call(this, intId);\n    \t\t  this.retryBtn.className = \"\";\n\t \t\t\t\tthis.retryBtn.disabled = false;\n    \t\t\tbreak;\n    \t}\n    }.bind(this), 20);\n};\n\nView.prototype.gameScreen = function(intId){\n\t\tthis.game.draw();\n    this.game.moveBubbles();\n    this.hasWon(intId);\n};\nView.prototype.startScreen = function(){\n\tthis.ctx.clearRect(0, 0, 640, 800);\n\tthis.ctx.font = \"64px Exo\";\n\tthis.ctx.fillStyle = \"black\";\n\tthis.ctx.fillText(\"PrimeOrdeal\", 150, 300);\n}\n\nView.prototype.instructionScreen = function(){\n\tthis.ctx.clearRect(0, 0, 640, 800);\n\n};\n\nView.prototype.hasWon = function() {\n\tif (this.game.lost()){\n\t\tthis.page = 5;\n\t}\n};\nView.prototype.loseScreen = function(){\n\tthis.ctx.clearRect(0, 0, 640, 800);\n  this.ctx.font = \"36px Exo\";\n\tthis.ctx.fillStyle = \"black\";\n\tthis.ctx.fillText(\"YOU LOST!\", 140, 140);\n\tthis.ctx.font = \"36px Exo\";\n\tthis.ctx.fillStyle = \"black\";\n\tthis.ctx.fillText(\"Your score was:\", 140, 340);\n\tthis.ctx.font = \"36px Exo\";\n\tthis.ctx.fillStyle = \"black\";\n\tthis.ctx.fillText(this.game.score, 140, 380);\n};\n\nmodule.exports = View;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/view.js\n ** module id = 1\n ** module chunks = 0\n **/","var Bubble = require('./bubble.js'),\n    Layout = require('./layout.js');\n\nvar Game = function(ctx, backFn, pauseFn){\n  this.ctx = ctx;\n  this.grid = Array.from(Array(8), function(spot){\n    return Array.from(Array(10));\n  });\n  this.backFn = backFn;\n  this.bubbles = [];\n  this.primes = [2, 3, 5, 7, 11,\n                13, 17, 19, 23,\n                29, 31, 33, 37, 41,\n                43, 47, 53, 59, 61,\n                67, 71];\n  this.colSums = Array.from(Array(8), function(_){return 0;});\n  this.turns = 0;\n  this.score = 0;\n  this.dropHiddenBubbles();\n  this.currentBubble = this.addBubble();\n  $(document).on(\"keydown\", this.updatePosition.bind(this));\n};\n\nGame.prototype.updateScore = function(numOfBubbles){\n  if (numOfBubbles === 0) return;\n  this.score += numOfBubbles > 7 ? 7 : 2 * Math.pow(2, 2 * numOfBubbles - 1);\n};\n\nGame.prototype.updatePosition = function(e){\n    var posY = this.currentBubble.pos_y,\n        col = this.currentBubble.col;\n\n    if (!this.currentBubble.autoFall){\n    switch (e.which){\n      case 32:\n        e.preventDefault();\n        this.currentBubble.setAutoFall();\n        break;\n      case 37:\n        e.preventDefault();\n        if (col >= 1 && posY < (this.maxHeightBubbleCanBe(col - 1))){\n          this.currentBubble.col--;\n        }\n        break;\n      case 39:\n        e.preventDefault();\n        if (col <= 6 && posY < (this.maxHeightBubbleCanBe(col + 1))){\n          this.currentBubble.col++;\n        }\n        break;\n    }\n  }\n};\nGame.prototype.maxHeightBubbleCanBe = function(col){\n  return 730 - ((this.grid[col].indexOf(undefined) + 1) * 60 + 30 + 30);\n};\n\nGame.prototype.addBubble = function(){\n  var speed = 1,\n      randomNum = (Math.random() * 7) <= 6 ? Math.ceil(Math.random() * 5 + 1) : 7,\n      col = Math.floor(Math.random() * 8),\n      newBubble = new Bubble(this.ctx, col, speed, randomNum);\n  this.bubbles.push(newBubble);\n  return newBubble;\n};\nGame.prototype.moveBubbles = function(){\n  this.moveCurrentBubble();\n  this.moveOtherBubbles();\n}\nGame.prototype.moveCurrentBubble = function(){\n  var bubbleCol = this.currentBubble.col,\n      currentCol = this.grid[this.currentBubble.col];\n  numOfBubblesInCol = currentCol.reduce(function(a, b){\n                                    return a + (!!b ? 1 : 0);\n                                  }, 0);\n  if (this.currentBubble.pos_y >= (730 - (numOfBubblesInCol * 60 + 30 + 30))){\n    this.grid[bubbleCol][numOfBubblesInCol] = this.currentBubble;\n    this.colSums[bubbleCol] += this.currentBubble.value;\n    this.currentBubble = this.addBubble();\n    this.turns++;\n\n    this.checkPrimesInRows();\n  } else {\n    this.currentBubble.fall();\n  }\n};\n\nGame.prototype.moveOtherBubbles = function(){\n  for (var i = 0; i < this.grid.length; i++){\n    var currentCol = this.grid[i];\n    if (currentCol.every(function(cell){return !cell;})) continue;\n    for (var j = 0; j < currentCol.length; j++){\n      if (!currentCol[j]) continue;\n      var currentBubble = currentCol[j];\n      if (currentBubble.pos_y < (730 - (j * 60 + 30 + 30))){\n          currentBubble.fall();\n      } else if (currentBubble.pos_y >  (730 - (j * 60 + 60))){\n        currentBubble.pos_y = 730 - (j * 60 + 60);\n      }\n    }\n  }\n};\n\nGame.prototype.dropHiddenBubbles = function(){\n  this.grid.forEach(function(col, idx){\n    var randomNum = (Math.random() * 7) <= 6 ? Math.ceil(Math.random() * 5 + 1) : 7;\n    var newBubble = new Bubble(this.ctx, idx, 10, randomNum, true, true);\n    col[col.indexOf(undefined)] = newBubble;\n    this.colSums[idx] += randomNum;\n    this.bubbles.push(newBubble);\n  }.bind(this));\n\n};\n\nGame.prototype.deleteBubbles = function(coords){\n  this.updateScore(coords.length);\n  var coords = coords.sort(function(a,b){\n    return b[1] - a[1];\n  });\n\n  for (var i = 0; i < coords.length; i++){\n    var coord = coords[i],\n    currentBubble = this.grid[coord[0]][coord[1]];\n    var idx = this.bubbles.findIndex(function(bubble){\n      return bubble.isEqual(currentBubble);\n    });\n    if (idx > -1){\n      this.colSums[coord[0]] -= currentBubble.value;\n      this.grid[coord[0]][coord[1]] = undefined;\n      this.unveilSurroundings(coord[0], coord[1]);\n      this.grid[coord[0]].splice(coord[1], 1);\n      this.grid[coord[0]].push(undefined);\n      this.bubbles.splice(idx, 1);\n    }\n  }\n};\n\nGame.prototype.unveilSurroundings = function(col, row){\n  if (col < 7 && this.grid[col + 1][row]) this.grid[col + 1][row].unveil();\n  if (col > 0 && this.grid[col - 1][row]) this.grid[col - 1][row].unveil();\n  if (this.grid[col][row + 1]) this.grid[col][row + 1].unveil();\n  if (this.grid[col][row - 1]) this.grid[col][row - 1].unveil();\n};\n\nGame.prototype.draw = function(){\n  this.ctx.clearRect(0, 0, 640, 800);\n  Layout.drawText.apply(this);\n  Layout.drawFrame.apply(this);\n\n  if (this.turns === 7){\n    this.turns = 0;\n    this.dropHiddenBubbles();\n  }\n  this.bubbles.forEach(function(bubble){\n      bubble.draw();\n  });\n};\n\n\nGame.prototype.lost = function(){\n\n  if (this.grid.some(function(col){\n    return col.every(function(cell){\n      return !!cell;\n    })\n  })){\n    return true;\n  }\n  return false;\n};\n\nGame.prototype.checkPrimesInRows = function(){\n  var bubblesToDelete = [];\n  for (var i = 0; i < this.grid[0].length; i++){\n\n    var currentSum = 0, startPoint = 0;\n    for (var j = 0; j < this.grid.length; j++){\n      if (typeof this.grid[j][i] === \"undefined\" || this.grid[j][i].hidden){\n        startPoint = j + 1;\n        currentSum = 0;\n        continue;\n      }\n      currentSum += this.grid[j][i].value;\n\n      if (j === (this.grid.length - 1) || typeof this.grid[j + 1][i] === \"undefined\"\n          || this.grid[j + 1][i].hidden){\n        if ((j - startPoint) > 0 && this.primes.indexOf(currentSum) > -1){\n          for (var m = startPoint; m <= j; m++){\n            bubblesToDelete.push([m, i]);\n          }\n        }\n        startPoint = j;\n        currentSum = 0;\n      }\n    }\n  }\n  this.checkPrimesInCols(bubblesToDelete);\n};\n\n\nGame.prototype.checkPrimesInCols = function(bubblesToDelete){\n  for (var j = 0; j < this.colSums.length; j++){\n    if (this.grid[j].findIndex(function(cell){\n          return !!cell && cell.hidden;\n        }) > -1){\n      continue;\n    }\n    if (this.primes.indexOf(this.colSums[j]) > -1 &&\n          this.grid[j].reduce(function(a,b){\n            return a + (!!b ? 1 : 0);\n          },0) > 1){\n      for (var m = 0; m < this.grid[j].length; m++){\n        if (typeof this.grid[j][m] === \"undefined\") break;\n\n        if (bubblesToDelete.findIndex(function(coord){\n           return coord.toString() === [j, m].toString();\n        }) === -1){\n           bubblesToDelete.push([j, m]);\n        }\n      }\n    }\n  }\n  this.deleteBubbles(bubblesToDelete);\n  this.updateScore(bubblesToDelete.length);\n};\nmodule.exports = Game;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/game.js\n ** module id = 2\n ** module chunks = 0\n **/","var Bubble = function(ctx, col, speed, value, autoFall, hidden){\n  this.ctx = ctx;\n  this.size = 30;\n  this.pos_y = 130;\n  this.col = col;\n  this.speed = speed;\n  this.value = value;\n  this.color = Bubble.color(value);\n  this.autoFall = autoFall || false;\n  this.hidden = hidden || false;\n  this.image = document.getElementById(\"source\");\n};\n\nBubble.color = function(value){\n  switch(value){\n    case 2:\n      return [0, 0];\n      break;\n    case 3:\n      return [202, 202];\n      break;\n    case 4:\n      return [404, 0];\n      break;\n    case 5:\n      return [404, 202];\n      break;\n    case 6:\n      return [202, 404];\n      break;\n    case 7:\n      return [0, 404];\n      break;\n  }\n};\nBubble.prototype.draw = function(){\n  var pos_x = this.col * 60 + 120 + 30;\n  var color = this.hidden ? [202, 0] : this.color;\n  this.ctx.beginPath();\n\n  this.ctx.drawImage(this.image, color[0], color[1], 200, 200, pos_x - 30, this.pos_y - 32, 65, 65);\n  if (!this.hidden){\n    this.ctx.font = \"20px Lato\";\n    this.ctx.strokeStyle = \"white\";\n    this.ctx.strokeText(this.value, pos_x - 5, this.pos_y + 5);\n  }\n};\n\nBubble.prototype.setAutoFall = function(){\n  this.autoFall = true;\n  this.speed = 10;\n};\n\nBubble.prototype.fall = function(){\n  this.pos_y += this.speed;\n};\n\nBubble.prototype.isEqual = function(bubble){\n  return !!bubble && this.pos_y === bubble.pos_y && this.col === bubble.col &&\n          this.value === bubble.value;\n};\n\nBubble.prototype.unveil = function(){\n  this.hidden = false;\n};\n\nmodule.exports = Bubble;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/bubble.js\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = {\n\tdrawText: function(){\n\t\tthis.ctx.font = \"36px Exo\";\n\t  this.ctx.fillStyle = \"black\";\n\t  this.ctx.fillText(\"PrimeOrdeal\", 220, 60);\n\t  this.ctx.font = \"24px Exo\";\n\t  this.ctx.fillText(\"Score\", 24, 300);\n\t  this.ctx.font = \"24px Exo\";\n\t  var textWidth = this.ctx.measureText(this.score).width;\n\t  this.ctx.fillText(this.score, textWidth + 48 - 1.3 * textWidth, 340);\n\t  this.ctx.font = \"24px Exo\";\n\t  this.ctx.fillText(\"Turns\", 22, 460);\n\t  this.ctx.fillText(\"left\", 32, 490);\n\t  this.ctx.font = \"24px Exo\";\n\t  this.ctx.fillText(7 - this.turns, 44, 530);\n\t},\n\tdrawFrame: function(){\n\t\tthis.ctx.beginPath();\n\t  this.ctx.lineWidth = 10;\n\t  this.ctx.moveTo(116, 100);\n\t  this.ctx.lineTo(116, 704);\n\t  this.ctx.lineTo(606, 704);\n\t  this.ctx.lineTo(606, 100);\n\t  this.ctx.lineTo(111, 100);\n\t  this.ctx.strokeStyle = \"#00203c\";\n\t  this.ctx.stroke();\n\t  this.ctx.globalAlpha = 0.8;\n\t  this.ctx.fillStyle = \"#00060b\";\n\t  this.ctx.fill();\n\t  this.ctx.closePath\t();\n\t  this.ctx.globalAlpha = 1;\n\t  this.ctx.lineWidth = 2;\n\t  this.ctx.fillStyle = \"black\";\n\t}\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/layout.js\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}